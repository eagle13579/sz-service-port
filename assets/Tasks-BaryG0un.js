import{u as k,r as p,o as T,c as r,a as e,m,v as _,D as y,b as i,F as C,y as D,z as g,s as V,j as n,p as S,t as o}from"./index-BeuDXI1d.js";const j={class:"min-h-screen bg-gray-50 py-8"},q={class:"container mx-auto px-6"},z={class:"bg-white rounded-lg shadow p-6 mb-6"},B={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},F={key:0,class:"text-center py-12"},M={key:1,class:"bg-white rounded-lg shadow p-12 text-center"},N={key:2,class:"space-y-4"},U={class:"flex flex-col md:flex-row md:items-center justify-between"},L={class:"flex-1"},$={class:"flex items-center mb-2"},A={class:"text-lg font-bold text-gray-800"},E={class:"text-gray-600 mb-3"},R={class:"flex items-center space-x-4 text-sm text-gray-500"},G={class:"mt-4 md:mt-0 md:ml-6"},H=["onClick","disabled"],K={__name:"Tasks",setup(I){k();const v=V(),d=p([]),u=p(!1),a=p({search:"",type:"",reward:""}),c=async()=>{try{u.value=!0;const l={};a.value.search&&(l.search=a.value.search),a.value.type&&(l.type=a.value.type);const t=await g.get("/api/tasks",{params:l});d.value=t.data.data}catch(l){console.error("Failed to load tasks:",l)}finally{u.value=!1}},f=async l=>{var t,s;try{await g.post(`/api/tasks/${l}/claim`),alert("任务领取成功！"),v.push("/member/my-tasks")}catch(x){alert(((s=(t=x.response)==null?void 0:t.data)==null?void 0:s.message)||"领取失败，请稍后重试")}},b=l=>({promotion:"bg-blue-100 text-blue-800",review:"bg-green-100 text-green-800",data:"bg-purple-100 text-purple-800"})[l]||"bg-gray-100 text-gray-800",w=l=>({promotion:"推广",review:"评价",data:"数据采集"})[l]||l,h=l=>new Date(l).toLocaleDateString("zh-CN");return T(()=>{c()}),(l,t)=>(n(),r("div",j,[e("div",q,[t[14]||(t[14]=e("div",{class:"mb-8 flex justify-between items-center"},[e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-800"},"任务大厅"),e("p",{class:"text-gray-600 mt-2"},"浏览并领取可用任务")])],-1)),e("div",z,[e("div",B,[e("div",null,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"搜索",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.search=s),type:"text",placeholder:"搜索任务...",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500"},null,512),[[_,a.value.search]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"任务类型",-1)),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.type=s),class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500"},[...t[4]||(t[4]=[e("option",{value:""},"全部类型",-1),e("option",{value:"promotion"},"推广",-1),e("option",{value:"review"},"评价",-1),e("option",{value:"data"},"数据采集",-1)])],512),[[y,a.value.type]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"奖励范围",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.reward=s),class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500"},[...t[6]||(t[6]=[e("option",{value:""},"全部",-1),e("option",{value:"0-50"},"0-50积分",-1),e("option",{value:"50-100"},"50-100积分",-1),e("option",{value:"100+"},"100+积分",-1)])],512),[[y,a.value.reward]])]),e("div",{class:"flex items-end"},[e("button",{onClick:c,class:"w-full bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition"},[...t[8]||(t[8]=[e("i",{class:"fas fa-search mr-2"},null,-1),i("搜索 ",-1)])])])])]),u.value?(n(),r("div",F,[...t[9]||(t[9]=[e("i",{class:"fas fa-spinner fa-spin text-primary-600 text-4xl"},null,-1)])])):d.value.length===0?(n(),r("div",M,[...t[10]||(t[10]=[e("i",{class:"fas fa-inbox text-gray-400 text-5xl mb-4"},null,-1),e("h3",{class:"text-xl font-semibold text-gray-800 mb-2"},"暂无任务",-1),e("p",{class:"text-gray-600"},"当前没有符合条件的任务",-1)])])):(n(),r("div",N,[(n(!0),r(C,null,D(d.value,s=>(n(),r("div",{key:s.id,class:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition"},[e("div",U,[e("div",L,[e("div",$,[e("span",{class:S([b(s.type),"px-3 py-1 rounded-full text-xs font-medium mr-3"])},o(w(s.type)),3),e("h3",A,o(s.title),1)]),e("p",E,o(s.description),1),e("div",R,[e("span",null,[t[11]||(t[11]=e("i",{class:"fas fa-star text-yellow-500 mr-1"},null,-1)),i(o(s.points)+"积分",1)]),e("span",null,[t[12]||(t[12]=e("i",{class:"fas fa-clock mr-1"},null,-1)),i("截止: "+o(h(s.deadline)),1)]),e("span",null,[t[13]||(t[13]=e("i",{class:"fas fa-user mr-1"},null,-1)),i("已领: "+o(s.claimed)+"/"+o(s.quota),1)])])]),e("div",G,[e("button",{onClick:x=>f(s.id),disabled:s.claimed>=s.quota,class:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},o(s.claimed>=s.quota?"已抢完":"领取任务"),9,H)])])]))),128))]))])]))}};export{K as default};
