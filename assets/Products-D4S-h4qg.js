import{r as n,o as F,c as o,a as e,l as k,b as m,F as M,y as T,t as i,k as q,m as c,v as g,z as x,j as r,p as D}from"./index-BeuDXI1d.js";const S={class:"min-h-screen bg-gray-50 py-8"},U={class:"container mx-auto px-6"},z={class:"mb-8 flex justify-between items-center"},B={key:0,class:"text-center py-12"},I={key:1,class:"bg-white rounded-lg shadow p-12 text-center"},N={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},A={class:"h-48 bg-gray-200 flex items-center justify-center relative"},E=["src","alt"],L={key:1,class:"fas fa-image text-gray-400 text-4xl"},G={class:"p-4"},H={class:"font-semibold text-gray-800 mb-2"},J={class:"text-sm text-gray-600 mb-2 line-clamp-2"},K={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2"},O={class:"text-lg font-bold text-primary-600"},Q={class:"flex space-x-2 w-full sm:w-auto"},R=["onClick"],W=["onClick"],X={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Y={class:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto"},Z={class:"p-6 border-b"},ee={class:"text-xl font-bold text-gray-800"},te={class:"grid grid-cols-2 gap-4"},se={class:"flex justify-end space-x-3"},ae=["disabled"],le={key:0,class:"fas fa-spinner fa-spin mr-2"},ne={__name:"Products",setup(oe){const f=n([]),y=n(!1),d=n(!1),u=n(null),p=n(!1),h=n(null),l=n({name:"",description:"",price:"",stock:"",image:null}),b=async()=>{try{y.value=!0;const a=await x.get("/api/products/my");f.value=a.data.data}catch(a){console.error("Failed to load products:",a)}finally{y.value=!1}},_=a=>{u.value=a,l.value={name:a.name,description:a.description,price:a.price,stock:a.stock,image:null},d.value=!0},C=async()=>{var a,t;try{p.value=!0;const s=new FormData;s.append("name",l.value.name),s.append("description",l.value.description),s.append("price",l.value.price),s.append("stock",l.value.stock),l.value.image&&s.append("image",l.value.image),u.value?await x.put(`/api/products/${u.value.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}):await x.post("/api/products",s,{headers:{"Content-Type":"multipart/form-data"}}),w(),b()}catch(s){alert(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"保存失败，请稍后重试")}finally{p.value=!1}},j=async a=>{var t,s;if(confirm("确定要删除这个产品吗？"))try{await x.delete(`/api/products/${a}`),b()}catch(v){alert(((s=(t=v.response)==null?void 0:t.data)==null?void 0:s.message)||"删除失败，请稍后重试")}},V=a=>{l.value.image=a.target.files[0]},w=()=>{d.value=!1,u.value=null,l.value={name:"",description:"",price:"",stock:"",image:null}},P=a=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",$=a=>({pending:"审核中",approved:"已上架",rejected:"已下架"})[a]||a;return F(()=>{b()}),(a,t)=>(r(),o("div",S,[e("div",U,[e("div",z,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-800"},"产品管理"),e("p",{class:"text-gray-600 mt-2"},"管理您的产品信息")],-1)),e("button",{onClick:t[0]||(t[0]=s=>d.value=!0),class:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 transition"},[...t[6]||(t[6]=[e("i",{class:"fas fa-plus mr-2"},null,-1),m("添加产品 ",-1)])])]),y.value?(r(),o("div",B,[...t[8]||(t[8]=[e("i",{class:"fas fa-spinner fa-spin text-primary-600 text-4xl"},null,-1)])])):f.value.length===0?(r(),o("div",I,[t[9]||(t[9]=e("i",{class:"fas fa-box-open text-gray-400 text-5xl mb-4"},null,-1)),t[10]||(t[10]=e("h3",{class:"text-xl font-semibold text-gray-800 mb-2"},"暂无产品",-1)),t[11]||(t[11]=e("p",{class:"text-gray-600 mb-4"},"您还没有发布任何产品",-1)),e("button",{onClick:t[1]||(t[1]=s=>d.value=!0),class:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 transition"}," 添加第一个产品 ")])):(r(),o("div",N,[(r(!0),o(M,null,T(f.value,s=>(r(),o("div",{key:s.id,class:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition"},[e("div",A,[s.image?(r(),o("img",{key:0,src:s.image,alt:s.name,class:"w-full h-full object-cover"},null,8,E)):(r(),o("i",L)),e("span",{class:D([P(s.status),"absolute top-2 right-2 px-2 py-1 rounded text-xs font-medium"])},i($(s.status)),3)]),e("div",G,[e("h3",H,i(s.name),1),e("p",J,i(s.description),1),e("div",K,[e("span",O,"¥"+i(s.price),1),e("div",Q,[e("button",{onClick:v=>_(s),class:"flex-1 sm:flex-none px-3 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition text-sm"},[...t[12]||(t[12]=[e("i",{class:"fas fa-edit mr-1"},null,-1),m("编辑 ",-1)])],8,R),e("button",{onClick:v=>j(s.id),class:"flex-1 sm:flex-none px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100 transition text-sm"},[...t[13]||(t[13]=[e("i",{class:"fas fa-trash mr-1"},null,-1),m("删除 ",-1)])],8,W)])])])]))),128))]))]),d.value?(r(),o("div",X,[e("div",Y,[e("div",Z,[e("h2",ee,i(u.value?"编辑产品":"添加产品"),1)]),e("form",{onSubmit:q(C,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"产品名称",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.name=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500",placeholder:"请输入产品名称"},null,512),[[g,l.value.name]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"产品描述",-1)),c(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.description=s),rows:"4",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500",placeholder:"请输入产品描述"},null,512),[[g,l.value.description]])]),e("div",te,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"价格",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.price=s),type:"number",step:"0.01",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500",placeholder:"请输入价格"},null,512),[[g,l.value.price]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"库存",-1)),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.stock=s),type:"number",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500",placeholder:"请输入库存"},null,512),[[g,l.value.stock]])])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"产品图片",-1)),e("input",{ref_key:"imageInput",ref:h,type:"file",accept:"image/*",onChange:V,class:"w-full"},null,544)]),e("div",se,[e("button",{type:"button",onClick:w,class:"px-6 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition"}," 取消 "),e("button",{type:"submit",disabled:p.value,class:"px-6 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition disabled:opacity-50"},[p.value?(r(),o("i",le)):k("",!0),m(" "+i(p.value?"保存中...":"保存"),1)],8,ae)])],32)])])):k("",!0)]))}};export{ne as default};
