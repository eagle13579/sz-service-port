# 数智服务港 - 自动配置完成指南

## 📦 已创建的自动化工具

### 1. 快速启动脚本

#### Windows批处理脚本 (推荐)
**文件**: `auto-setup-complete.bat`

**使用方法**:
```cmd
# 方法1: 直接双击运行
auto-setup-complete.bat

# 方法2: 在命令行中运行
cd "c:/Users/56867/CodeBuddy/数智服务港/官网"
auto-setup-complete.bat
```

#### PowerShell脚本
**文件**: `auto-setup.ps1`

**使用方法**:
```powershell
# 方法1: 在PowerShell中运行
powershell -ExecutionPolicy Bypass -File "c:/Users/56867/CodeBuddy/数智服务港/官网/auto-setup.ps1"

# 方法2: 右键脚本 -> 使用PowerShell运行
```

---

## 🚀 脚本功能

### 自动完成的步骤

1. ✅ **检查Docker服务状态**
   - 验证Docker是否正在运行
   - 如果未运行，提示用户启动Docker Desktop

2. ✅ **检查MySQL容器状态**
   - 检测容器是否存在
   - 如果不存在，创建新容器
   - 如果已停止，启动容器
   - 如果正在运行，跳过此步骤

3. ✅ **等待MySQL服务启动**
   - 自动等待20秒让MySQL完全启动
   - 避免连接失败

4. ✅ **初始化数据库**
   - 自动导入 `unified-database-init.sql`
   - 创建所有数据表
   - 初始化测试数据

5. ✅ **验证数据库连接**
   - 测试数据库连接是否正常
   - 显示数据表列表

---

## 📊 配置信息

### MySQL数据库

```yaml
主机: localhost
端口: 3306
用户: root
密码: root123
数据库: shuzhi_service_hub
```

### 后端服务

```yaml
地址: http://localhost:3002
健康检查: http://localhost:3002/health
API前缀: /api
```

### 前端服务

```yaml
地址: http://localhost:5173
开发模式: npm run dev
```

---

## 🎯 使用流程

### 完整启动流程

```cmd
# 1. 运行自动配置脚本
auto-setup-complete.bat

# 2. 等待脚本执行完成（约30秒）

# 3. 启动后端服务
cd unified-backend
npm run dev

# 4. 启动前端服务（新终端）
cd unified-frontend
npm run dev

# 5. 测试服务
# 后端健康检查: http://localhost:3002/health
# 前端页面: http://localhost:5173
```

---

## 🔍 故障排除

### 问题1: Docker未运行

**错误信息**: `[错误] Docker未运行，请先启动Docker Desktop`

**解决方案**:
1. 打开Docker Desktop
2. 等待Docker完全启动
3. 重新运行脚本

### 问题2: 端口3306被占用

**错误信息**: 端口冲突错误

**解决方案**:
```cmd
# 检查占用端口的进程
netstat -ano | findstr :3306

# 停止冲突的服务或修改端口
# 在脚本中修改: -p 3307:3306
```

### 问题3: 数据库初始化失败

**错误信息**: `[警告] 数据库初始化可能已完成或遇到问题`

**解决方案**:
```cmd
# 手动初始化数据库
docker exec -i shuzhi-mysql mysql -uroot -proot123 shuzhi_service_hub < unified-database-init.sql

# 或检查日志
docker logs shuzhi-mysql
```

### 问题4: 后端连接数据库失败

**检查步骤**:
1. 确认MySQL容器正在运行
   ```cmd
   docker ps | findstr shuzhi-mysql
   ```

2. 测试数据库连接
   ```cmd
   docker exec -it shuzhi-mysql mysql -uroot -proot123 -e "SELECT 1"
   ```

3. 检查后端配置
   ```cmd
   # 查看unified-backend/.env文件
   type unified-backend\.env
   ```

---

## 📝 验证步骤

### 1. 验证MySQL容器

```cmd
docker ps | findstr shuzhi-mysql
```

**预期输出**:
```
CONTAINER ID   IMAGE     STATUS         PORTS
abc123...      mysql:8.0  Up 30 seconds  0.0.0.0:3306->3306/tcp
```

### 2. 验证数据库连接

```cmd
docker exec shuzhi-mysql mysql -uroot -proot123 -e "USE shuzhi_service_hub; SHOW TABLES;"
```

**预期输出**:
```
+---------------------------+
| Tables_in_shuzhi_service_hub |
+---------------------------+
| users                     |
| suppliers                 |
| members                   |
| tasks                     |
| products                  |
| activities                |
| rewards                   |
| reviews                   |
| orders                    |
| member_activities         |
| member_rewards            |
+---------------------------+
```

### 3. 验证后端服务

```cmd
curl http://localhost:3002/health
```

**预期输出**:
```json
{
  "status": "ok",
  "message": "数智服务港统一后端服务运行正常",
  "database": "connected"
}
```

### 4. 验证前端服务

浏览器访问: http://localhost:5173

**预期结果**: 页面正常加载，显示数智服务港主页

---

## 🎨 开发模式

### 使用模拟数据开发

如果不想配置数据库，可以使用模拟数据：

**步骤**:
1. 编辑 `unified-frontend/src/utils/api.js`
2. 修改配置:
   ```javascript
   const USE_MOCK_DATA = true
   ```
3. 重启前端服务
4. 开始开发

**优点**:
- ✅ 无需数据库
- ✅ 立即可用
- ✅ 适合前端开发

### 使用真实数据库开发

推荐用于完整的开发和测试：

**步骤**:
1. 运行 `auto-setup-complete.bat`
2. 启动后端服务
3. 编辑 `unified-frontend/src/utils/api.js`
4. 修改配置:
   ```javascript
   const USE_MOCK_DATA = false
   ```
5. 开始开发

**优点**:
- ✅ 数据持久化
- ✅ 真实API测试
- ✅ 完整功能验证

---

## 📚 相关文档

| 文档 | 说明 |
|------|------|
| `开发总结报告.md` | 完整的开发总结 |
| `使用模拟数据开发指南.md` | 模拟数据使用方法 |
| `当前开发状态和下一步指南.md` | 开发状态和指南 |
| `完整功能测试报告.md` | 功能测试报告 |

---

## 🚀 快速参考

### 常用命令

```cmd
# 启动所有服务
auto-setup-complete.bat
cd unified-backend && npm run dev
cd unified-frontend && npm run dev

# 停止MySQL容器
docker stop shuzhi-mysql

# 启动MySQL容器
docker start shuzhi-mysql

# 查看MySQL日志
docker logs shuzhi-mysql

# 重启MySQL容器
docker restart shuzhi-mysql

# 删除MySQL容器（谨慎使用）
docker stop shuzhi-mysql
docker rm shuzhi-mysql
```

### 访问地址

```
前端:      http://localhost:5173
后端:      http://localhost:3002
健康检查:  http://localhost:3002/health
测试系统:  http://localhost:5173/测试系统.html
```

---

## 💡 最佳实践

1. **首次使用**: 运行 `auto-setup-complete.bat`
2. **日常开发**: 直接启动服务即可（容器会自动保留）
3. **测试数据**: 数据库初始化脚本会创建测试数据
4. **开发模式**: 根据需要选择模拟数据或真实数据库
5. **问题排查**: 查看Docker日志和后端日志

---

## 🎉 总结

**自动化配置工具已完成！**

✅ 两个自动配置脚本（BAT和PS1）
✅ 完整的使用说明
✅ 详细的故障排除
✅ 清晰的验证步骤

**现在可以快速启动整个开发环境！** 🚀
