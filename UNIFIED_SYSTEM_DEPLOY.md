# æ•°æ™ºæœåŠ¡æ¸¯ç»Ÿä¸€ç³»ç»Ÿéƒ¨ç½²æŒ‡å—

**ç‰ˆæœ¬**: v1.0  
**æ—¥æœŸ**: 2026-01-08  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

æ•°æ™ºæœåŠ¡æ¸¯ç»Ÿä¸€ç³»ç»Ÿæ•´åˆäº†ï¼š
- âœ… **ä¾›åº”é“¾å¹³å°**: ä¾›åº”å•†ç®¡ç†ã€äº§å“å‘å¸ƒã€ä»»åŠ¡å‘å¸ƒ
- âœ… **ä¼šå‘˜ä½“ç³»**: ä¼šå‘˜ç®¡ç†ã€æŠ€èƒ½è®¤è¯ã€ä¿¡ç”¨è¯„çº§
- âœ… **ä»»åŠ¡ç³»ç»Ÿ**: ä»»åŠ¡è®¤é¢†ã€è¿›åº¦è¿½è¸ªã€å›æŠ¥ç»“ç®—

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å‰ç«¯å±‚                        â”‚
â”‚  Vue 3 + Vue Router + Pinia + Tailwind CSS    â”‚
â”‚  Port: 5173                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API ç½‘å…³ (Nginx å¯é€‰)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åç«¯æœåŠ¡å±‚                         â”‚
â”‚  Express.js + JWT + Bcrypt                      â”‚
â”‚  Port: 3002                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®å­˜å‚¨å±‚                           â”‚
â”‚  MySQL (ç»Ÿä¸€æ•°æ®åº“: shuzhi_service_hub)         â”‚
â”‚  Port: 3306                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. æ•°æ®åº“éƒ¨ç½²

#### 1.1 å®‰è£… MySQL

**Windows:**
```bash
# ä¸‹è½½å¹¶å®‰è£… MySQL Installer
# https://dev.mysql.com/downloads/installer/
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt update
sudo apt install mysql-server
sudo mysql_secure_installation
```

**macOS:**
```bash
brew install mysql
brew services start mysql
```

#### 1.2 åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç™»å½• MySQL
mysql -u root -p

# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
source /path/to/unified-database-init.sql

# æˆ–è€…ç›´æ¥æ‰§è¡Œ
mysql -u root -p < /path/to/unified-database-init.sql
```

#### 1.3 åˆ›å»ºæ•°æ®åº“ç”¨æˆ·ï¼ˆå¯é€‰ï¼‰

```sql
-- åˆ›å»ºä¸“ç”¨æ•°æ®åº“ç”¨æˆ·
CREATE USER 'shuzhi_hub'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON shuzhi_service_hub.* TO 'shuzhi_hub'@'localhost';
FLUSH PRIVILEGES;
```

### 2. åç«¯æœåŠ¡éƒ¨ç½²

#### 2.1 å®‰è£…ä¾èµ–

```bash
cd unified-backend
npm install
```

#### 2.2 é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶
notepad .env  # Windows
# æˆ–
vim .env  # Linux/macOS
```

**.env é…ç½®ç¤ºä¾‹ï¼š**

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=shuzhi_service_hub

# JWTé…ç½®
JWT_SECRET=your_very_secure_jwt_secret_key_change_this_in_production
JWT_EXPIRES_IN=24h

# æœåŠ¡å™¨é…ç½®
PORT=3002
NODE_ENV=production

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_PATH=./uploads
```

#### 2.3 å¯åŠ¨åç«¯æœåŠ¡

**å¼€å‘æ¨¡å¼:**
```bash
npm run dev
```

**ç”Ÿäº§æ¨¡å¼:**
```bash
npm start
```

**ä½¿ç”¨ PM2 ç®¡ç†ï¼ˆæ¨èï¼‰:**

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start unified-backend/app.js --name "shuzhi-hub-backend"

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs shuzhi-hub-backend

# é‡å¯
pm2 restart shuzhi-hub-backend

# å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

#### 2.4 éªŒè¯åç«¯æœåŠ¡

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3002/health

# é¢„æœŸå“åº”
{
  "status": "ok",
  "message": "æ•°æ™ºæœåŠ¡æ¸¯ç»Ÿä¸€åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸",
  "database": "connected"
}
```

### 3. å‰ç«¯éƒ¨ç½²

#### 3.1 å®‰è£…ä¾èµ–

```bash
cd unified-frontend
npm install
```

#### 3.2 å¼€å‘æ¨¡å¼å¯åŠ¨

```bash
npm run dev
```

è®¿é—®: http://localhost:5173

#### 3.3 ç”Ÿäº§æ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ç”Ÿæˆçš„æ–‡ä»¶åœ¨ dist ç›®å½•
```

#### 3.4 éƒ¨ç½²åˆ°é™æ€æœåŠ¡å™¨

**æ–¹å¼ 1: ä½¿ç”¨ Vite Preview**

```bash
npm run preview
```

**æ–¹å¼ 2: ä½¿ç”¨ Nginx**

1. æ„å»ºé¡¹ç›®:
```bash
npm run build
```

2. é…ç½® Nginx:

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    root /path/to/unified-frontend/dist;
    index index.html;
    
    # å¯ç”¨ gzip å‹ç¼©
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    
    # Vue Router history æ¨¡å¼
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # API ä»£ç†åˆ°åç«¯
    location /api {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

3. é‡å¯ Nginx:

```bash
nginx -t
nginx -s reload
```

**æ–¹å¼ 3: éƒ¨ç½²åˆ° GitHub Pages**

```bash
# å®‰è£… gh-pages
npm install -g gh-pages

# æ„å»º
npm run build

# éƒ¨ç½²
gh-pages -d dist
```

### 4. Nginx å®Œæ•´é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

```nginx
# HTTP é‡å®šå‘åˆ° HTTPS
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}

# HTTPS é…ç½®
server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSL è¯ä¹¦é…ç½®
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # å®‰å…¨å¤´éƒ¨
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /path/to/unified-frontend/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
        
        # ç¼“å­˜é…ç½®
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # API ä»£ç†
    location /api {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # è¶…æ—¶é…ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
```

---

## ğŸ“Š éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æ•°æ®åº“

- [ ] MySQL å·²å®‰è£…å¹¶å¯åŠ¨
- [ ] æ•°æ®åº“ `shuzhi_service_hub` å·²åˆ›å»º
- [ ] æ‰€æœ‰è¡¨å·²åˆ›å»º
- [ ] è§¦å‘å™¨å·²åˆ›å»º
- [ ] è§†å›¾å·²åˆ›å»º
- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡

### åç«¯

- [ ] Node.js å·²å®‰è£… (v14+)
- [ ] ä¾èµ–å·²å®‰è£…
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] åç«¯æœåŠ¡å·²å¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥æ¥å£æ­£å¸¸
- [ ] API æ¥å£å¯è®¿é—®
- [ ] JWT å¯†é’¥å·²ä¿®æ”¹
- [ ] PM2 è¿›ç¨‹ç®¡ç†å·²é…ç½®ï¼ˆå¯é€‰ï¼‰

### å‰ç«¯

- [ ] Node.js å·²å®‰è£…
- [ ] ä¾èµ–å·²å®‰è£…
- [ ] å¼€å‘ç¯å¢ƒå¯æ­£å¸¸è®¿é—®
- [ ] ç”Ÿäº§æ„å»ºæˆåŠŸ
- [ ] é™æ€æœåŠ¡å™¨å·²é…ç½®
- [ ] HTTPS å·²é…ç½®ï¼ˆç”Ÿäº§ï¼‰
- [ ] API ä»£ç†å·²é…ç½®

### å®‰å…¨

- [ ] å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†
- [ ] JWT å¯†é’¥å·²ä¿®æ”¹ä¸ºå¼ºå¯†é’¥
- [ ] æ•°æ®åº“å¯†ç å·²ä¿®æ”¹
- [ ] HTTPS å·²å¯ç”¨
- [ ] å®‰å…¨å¤´éƒ¨å·²é…ç½®
- [ ] CORS å·²æ­£ç¡®é…ç½®

---

## ğŸ§ª æµ‹è¯•

### 1. åç«¯ API æµ‹è¯•

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3002/health

# æ³¨å†Œç”¨æˆ·
curl -X POST http://localhost:3002/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test_user",
    "email": "test@example.com",
    "phone": "13800000000",
    "password": "password123",
    "role": "member"
  }'

# ç™»å½•
curl -X POST http://localhost:3002/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test_user",
    "password": "password123"
  }'

# è·å–ä»»åŠ¡åˆ—è¡¨ï¼ˆéœ€è¦ tokenï¼‰
curl http://localhost:3002/api/tasks \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

### 2. å‰ç«¯åŠŸèƒ½æµ‹è¯•

**æµ‹è¯•è´¦å·:**

1. **ç®¡ç†å‘˜è´¦å·**
   - ç”¨æˆ·å: admin
   - å¯†ç : éœ€è¦å…ˆæ³¨å†Œ

2. **ä¾›åº”å•†è´¦å·**
   - æ³¨å†Œæ—¶é€‰æ‹©"ä¾›åº”å•†"è§’è‰²
   - å¯ä»¥å‘å¸ƒäº§å“å’Œä»»åŠ¡

3. **ä¼šå‘˜è´¦å·**
   - æ³¨å†Œæ—¶é€‰æ‹©"ä¼šå‘˜"è§’è‰²
   - å¯ä»¥è®¤é¢†ä»»åŠ¡å’Œå‚åŠ æ´»åŠ¨

**æµ‹è¯•æµç¨‹:**

1. **æ³¨å†Œä¼šå‘˜**
   - è®¿é—® /register
   - é€‰æ‹©"ä¼šå‘˜"è§’è‰²
   - å¡«å†™ä¿¡æ¯å¹¶æäº¤

2. **æµè§ˆä»»åŠ¡**
   - è®¿é—® /member/tasks
   - æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨
   - ç­›é€‰å’Œæœç´¢

3. **è®¤é¢†ä»»åŠ¡**
   - ç‚¹å‡»ä»»åŠ¡æŸ¥çœ‹è¯¦æƒ…
   - ç‚¹å‡»"è®¤é¢†ä»»åŠ¡"
   - å¡«å†™è®¤é¢†ç†ç”±

4. **ç™»å½•ä¾›åº”å•†**
   - æ³¨å†Œæˆ–ç™»å½•ä¾›åº”å•†è´¦å·
   - è®¿é—® /supplier
   - å‘å¸ƒäº§å“å’Œä»»åŠ¡

5. **å®¡æ ¸è®¤é¢†**
   - ä¾›åº”å•†æŸ¥çœ‹ä»»åŠ¡è®¤é¢†ç”³è¯·
   - å®¡æ ¸é€šè¿‡æˆ–æ‹’ç»

6. **æ›´æ–°è¿›åº¦**
   - ä¼šå‘˜è®¿é—® /member/my-tasks
   - æ›´æ–°ä»»åŠ¡è¿›åº¦
   - æäº¤äº¤ä»˜ç‰©

---

## ğŸ”§ æ•…éšœæ’é™¤

### æ•°æ®åº“è¿æ¥å¤±è´¥

**é—®é¢˜:** `Error: connect ECONNREFUSED 127.0.0.1:3306`

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥ MySQL æ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç 
4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### å‰ç«¯æ— æ³•è®¿é—®åç«¯ API

**é—®é¢˜:** `Network Error` æˆ– `404 Not Found`

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ API ä»£ç†é…ç½®
3. æ£€æŸ¥ CORS è®¾ç½®
4. æ£€æŸ¥ç½‘ç»œè¿æ¥

### JWT Token æ— æ•ˆ

**é—®é¢˜:** `401 Unauthorized`

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥ JWT_SECRET æ˜¯å¦ä¸€è‡´
2. æ£€æŸ¥ token æ˜¯å¦è¿‡æœŸ
3. æ¸…é™¤ localStorage é‡æ–°ç™»å½•

---

## ğŸ“ ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–

### 1. æ€§èƒ½ä¼˜åŒ–

- [ ] å¯ç”¨ Gzip å‹ç¼©
- [ ] é…ç½® CDN åŠ é€Ÿ
- [ ] ä½¿ç”¨ Redis ç¼“å­˜
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- [ ] å›¾ç‰‡æ‡’åŠ è½½
- [ ] ä»£ç åˆ†å‰²

### 2. å®‰å…¨åŠ å›º

- [ ] å¯ç”¨ HTTPS
- [ ] é…ç½®é˜²ç«å¢™
- [ ] é™åˆ¶ API è¯·æ±‚é¢‘ç‡
- [ ] å®šæœŸå¤‡ä»½æ•°æ®åº“
- [ ] é…ç½® WAF
- [ ] å®šæœŸæ›´æ–°ä¾èµ–

### 3. ç›‘æ§å‘Šè­¦

- [ ] é…ç½®æ—¥å¿—æ”¶é›†
- [ ] è®¾ç½®æ€§èƒ½ç›‘æ§
- [ ] é…ç½®é”™è¯¯å‘Šè­¦
- [ ] ç›‘æ§æœåŠ¡å™¨èµ„æº
- [ ] ç›‘æ§æ•°æ®åº“æ€§èƒ½

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š

- **å¼€å‘éœ€æ±‚æ–‡æ¡£**: `å¼€å‘éœ€æ±‚æ–‡æ¡£.md`
- **æ•´åˆå®ŒæˆæŠ¥å‘Š**: `ä¸‰å¤§ç³»ç»Ÿæ•´åˆå®ŒæˆæŠ¥å‘Š.md`
- **åç«¯ API æ–‡æ¡£**: `unified-backend/README.md`
- **æ•°æ®åº“è„šæœ¬**: `unified-database-init.sql`

---

## âœ… éƒ¨ç½²å®Œæˆ

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å°†æ‹¥æœ‰ï¼š

1. **å®Œæ•´çš„ç»Ÿä¸€åç«¯æœåŠ¡**
   - 30 ä¸ª API æ¥å£
   - ç»Ÿä¸€è®¤è¯å’Œæˆæƒ
   - å®Œæ•´çš„æ•°æ®å…³è”

2. **ç°ä»£åŒ–çš„å‰ç«¯ç•Œé¢**
   - Vue 3 + Tailwind CSS
   - å“åº”å¼è®¾è®¡
   - æµç•…çš„ç”¨æˆ·ä½“éªŒ

3. **ä¸‰å¤§ç³»ç»Ÿå®Œå…¨æ‰“é€š**
   - ä¾›åº”é“¾å¹³å°
   - ä¼šå‘˜ä½“ç³»
   - ä»»åŠ¡ç³»ç»Ÿ

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
